db.mentalhealth.updateMany({Composer: 'Sí'}, {$set: {Composer: 'Yes'}});

db.mentalhealth.updateMany({Exploratory: 'Sí'}, {$set: {Exploratory: 'Yes'}});

db.mentalhealth.updateMany({'Foreign languages': 'Sí'}, {$set: {'Foreign languages': 'Yes'}});

db.mentalhealth.updateMany({'Instrumentalist': 'Sí'}, {$set: {'Instrumentalist': 'Yes'}});

db.mentalhealth.updateMany({'While working': 'Sí'}, {$set: {'While working': 'Yes'}});

db.mentalhealth.updateMany({'Music effects': 'Mejora'}, {$set: {'Music effects': 'Improve'}});
db.mentalhealth.updateMany({'Music effects': 'No tiene efecto'}, {$set: {'Music effects': 'No effect'}});
db.mentalhealth.updateMany({'Music effects': 'Empeora'}, {$set: {'Music effects': 'Worsen'}});



db.mentalhealth.updateMany({'Frequency [Classical]': 'Muy frecuentemente'}, {$set: {'Frequency [Classical]': 'Very frequently'}});
db.mentalhealth.updateMany({'Frequency [Classical]': 'A veces'}, {$set: {'Frequency [Classical]': 'Sometimes'}});
db.mentalhealth.updateMany({'Frequency [Classical]': 'Casi nunca'}, {$set: {'Frequency [Classical]': 'Rarely'}});
db.mentalhealth.updateMany({'Frequency [Classical]': 'Nunca'}, {$set: {'Frequency [Classical]': 'Never'}});


db.mentalhealth.updateMany({'Frequency [Country]': 'Muy frecuentemente'}, {$set: {'Frequency [Country]': 'Very frequently'}});
db.mentalhealth.updateMany({'Frequency [Country]': 'A veces'}, {$set: {'Frequency [Country]': 'Sometimes'}});
db.mentalhealth.updateMany({'Frequency [Country]': 'Casi nunca'}, {$set: {'Frequency [Country]': 'Rarely'}});
db.mentalhealth.updateMany({'Frequency [Country]': 'Nunca'}, {$set: {'Frequency [Country]': 'Never'}});


db.mentalhealth.updateMany({'Frequency [EDM]': 'Muy frecuentemente'}, {$set: {'Frequency [EDM]': 'Very frequently'}});
db.mentalhealth.updateMany({'Frequency [EDM]': 'A veces'}, {$set: {'Frequency [EDM]': 'Sometimes'}});
db.mentalhealth.updateMany({'Frequency [EDM]': 'Casi nunca'}, {$set: {'Frequency [EDM]': 'Rarely'}});
db.mentalhealth.updateMany({'Frequency [EDM]': 'Nunca'}, {$set: {'Frequency [EDM]': 'Never'}});

db.mentalhealth.updateMany({'Frequency [Folk]': 'Muy frecuentemente'}, {$set: {'Frequency [Folk]': 'Very frequently'}});
db.mentalhealth.updateMany({'Frequency [Folk]': 'A veces'}, {$set: {'Frequency [Folk]': 'Sometimes'}});
db.mentalhealth.updateMany({'Frequency [Folk]': 'Casi nunca'}, {$set: {'Frequency [Folk]': 'Rarely'}});
db.mentalhealth.updateMany({'Frequency [Folk]': 'Nunca'}, {$set: {'Frequency [Folk]': 'Never'}});


db.mentalhealth.updateMany({'Frequency [Gospel]': 'Muy frecuentemente'}, {$set: {'Frequency [Gospel]': 'Very frequently'}});
db.mentalhealth.updateMany({'Frequency [Gospel]': 'A veces'}, {$set: {'Frequency [Gospel]': 'Sometimes'}});
db.mentalhealth.updateMany({'Frequency [Gospel]': 'Casi nunca'}, {$set: {'Frequency [Gospel]': 'Rarely'}});
db.mentalhealth.updateMany({'Frequency [Gospel]': 'Nunca'}, {$set: {'Frequency [Gospel]': 'Never'}});


db.mentalhealth.updateMany({'Frequency [Hip hop]': 'Muy frecuentemente'}, {$set: {'Frequency [Hip hop]': 'Very frequently'}});
db.mentalhealth.updateMany({'Frequency [Hip hop]': 'A veces'}, {$set: {'Frequency [Hip hop]': 'Sometimes'}});
db.mentalhealth.updateMany({'Frequency [Hip hop]': 'Casi nunca'}, {$set: {'Frequency [Hip hop]': 'Rarely'}});
db.mentalhealth.updateMany({'Frequency [Hip hop]': 'Nunca'}, {$set: {'Frequency [Hip hop]': 'Never'}});;


db.mentalhealth.updateMany({'Frequency [Jazz]': 'Muy frecuentemente'}, {$set: {'Frequency [Jazz]': 'Very frequently'}});
db.mentalhealth.updateMany({'Frequency [Jazz]': 'A veces'}, {$set: {'Frequency [Jazz]': 'Sometimes'}});
db.mentalhealth.updateMany({'Frequency [Jazz]': 'Casi nunca'}, {$set: {'Frequency [Jazz]': 'Rarely'}});
db.mentalhealth.updateMany({'Frequency [Jazz]': 'Nunca'}, {$set: {'Frequency [Jazz]': 'Never'}});


db.mentalhealth.updateMany({'Frequency [K pop]': 'Muy frecuentemente'}, {$set: {'Frequency [K pop]': 'Very frequently'}});
db.mentalhealth.updateMany({'Frequency [K pop]': 'A veces'}, {$set: {'Frequency [K pop]': 'Sometimes'}});
db.mentalhealth.updateMany({'Frequency [K pop]': 'Casi nunca'}, {$set: {'Frequency [K pop]': 'Rarely'}});
db.mentalhealth.updateMany({'Frequency [K pop]': 'Nunca'}, {$set: {'Frequency [K pop]': 'Never'}});


db.mentalhealth.updateMany({'Frequency [Latin]': 'Muy frecuentemente'}, {$set: {'Frequency [Latin]': 'Very frequently'}});
db.mentalhealth.updateMany({'Frequency [Latin]': 'A veces'}, {$set: {'Frequency [Latin]': 'Sometimes'}});
db.mentalhealth.updateMany({'Frequency [Latin]': 'Casi nunca'}, {$set: {'Frequency [Latin]': 'Rarely'}});
db.mentalhealth.updateMany({'Frequency [Latin]': 'Nunca'}, {$set: {'Frequency [Latin]': 'Never'}});


db.mentalhealth.updateMany({'Frequency [Lofi]': 'Muy frecuentemente'}, {$set: {'Frequency [Lofi]': 'Very frequently'}});
db.mentalhealth.updateMany({'Frequency [Lofi]': 'A veces'}, {$set: {'Frequency [Lofi]': 'Sometimes'}});
db.mentalhealth.updateMany({'Frequency [Lofi]': 'Casi nunca'}, {$set: {'Frequency [Lofi]': 'Rarely'}});
db.mentalhealth.updateMany({'Frequency [Lofi]': 'Nunca'}, {$set: {'Frequency [Lofi]': 'Never'}});


db.mentalhealth.updateMany({'Frequency [Metal]': 'Muy frecuentemente'}, {$set: {'Frequency [Metal]': 'Very frequently'}});
db.mentalhealth.updateMany({'Frequency [Metal]': 'A veces'}, {$set: {'Frequency [Metal]': 'Sometimes'}});
db.mentalhealth.updateMany({'Frequency [Metal]': 'Casi nunca'}, {$set: {'Frequency [Metal]': 'Rarely'}});
db.mentalhealth.updateMany({'Frequency [Metal]': 'Nunca'}, {$set: {'Frequency [Metal]': 'Never'}});


db.mentalhealth.updateMany({'Frequency [Pop]': 'Muy frecuentemente'}, {$set: {'Frequency [Pop]': 'Very frequently'}});
db.mentalhealth.updateMany({'Frequency [Pop]': 'A veces'}, {$set: {'Frequency [Pop]': 'Sometimes'}});
db.mentalhealth.updateMany({'Frequency [Pop]': 'Casi nunca'}, {$set: {'Frequency [Pop]': 'Rarely'}});
db.mentalhealth.updateMany({'Frequency [Pop]': 'Nunca'}, {$set: {'Frequency [Pop]': 'Never'}});


db.mentalhealth.updateMany({'Frequency [R&B]': 'Muy frecuentemente'}, {$set: {'Frequency [R&B]': 'Very frequently'}});
db.mentalhealth.updateMany({'Frequency [R&B]': 'A veces'}, {$set: {'Frequency [R&B]': 'Sometimes'}});
db.mentalhealth.updateMany({'Frequency [R&B]': 'Casi nunca'}, {$set: {'Frequency [R&B]': 'Rarely'}});
db.mentalhealth.updateMany({'Frequency [R&B]': 'Nunca'}, {$set: {'Frequency [R&B]': 'Never'}});


db.mentalhealth.updateMany({'Frequency [Rap]': 'Muy frecuentemente'}, {$set: {'Frequency [Rap]': 'Very frequently'}});
db.mentalhealth.updateMany({'Frequency [Rap]': 'A veces'}, {$set: {'Frequency [Rap]': 'Sometimes'}});
db.mentalhealth.updateMany({'Frequency [Rap]': 'Casi nunca'}, {$set: {'Frequency [Rap]': 'Rarely'}});
db.mentalhealth.updateMany({'Frequency [Rap]': 'Nunca'}, {$set: {'Frequency [Rap]': 'Never'}});


db.mentalhealth.updateMany({'Frequency [Rock]': 'Muy frecuentemente'}, {$set: {'Frequency [Rock]': 'Very frequently'}});
db.mentalhealth.updateMany({'Frequency [Rock]': 'A veces'}, {$set: {'Frequency [Rock]': 'Sometimes'}});
db.mentalhealth.updateMany({'Frequency [Rock]': 'Casi nunca'}, {$set: {'Frequency [Rock]': 'Rarely'}});
db.mentalhealth.updateMany({'Frequency [Rock]': 'Nunca'}, {$set: {'Frequency [Rock]': 'Never'}});

db.mentalhealth.updateMany({'Frequency [Video game music]': 'Muy frecuentemente'}, {$set: {'Frequency [Video game music]': 'Very frequently'}});
db.mentalhealth.updateMany({'Frequency [Video game music]': 'A veces'}, {$set: {'Frequency [Video game music]': 'Sometimes'}});
db.mentalhealth.updateMany({'Frequency [Video game music]': 'Casi nunca'}, {$set: {'Frequency [Video game music]': 'Rarely'}});
db.mentalhealth.updateMany({'Frequency [Video game music]': 'Nunca'}, {$set: {'Frequency [Video game music]': 'Never'}});



 
db.mentalhealth.updateMany({ Anxiety: { $gte: 0, $lte: 3}}, {$set: { Anxiety_category: 'Low self-perception'}});
db.mentalhealth.updateMany({ Anxiety: { $gt: 3, $lte: 7}}, { $set: { Anxiety_category: 'Medium self-perception'}});
db.mentalhealth.updateMany({ Anxiety: { $gt: 7, $lte: 10}}, { $set: { Anxiety_category: 'High self-perception'}});

db.mentalhealth.updateMany({ Depression: { $gte: 0, $lte: 3}},{ $set: { Depression_category: 'Low self-perception'}});
db.mentalhealth.updateMany({ Depression: { $gt: 3, $lte: 7}}, { $set: { Depression_category: 'Medium self-perception'}});
db.mentalhealth.updateMany({ Depression: { $gt: 7, $lte: 10}},{ $set: { Depression_category: 'High self-perception'}});

db.mentalhealth.updateMany({ Insomnia: { $gte: 0, $lte: 3}},{ $set: { Insomnia_categoy: 'Low self-perception'}});
db.mentalhealth.updateMany({ Insomnia: { $gt: 3, $lte: 7}},{ $set: { Insomnia_categoy: 'Medium self-perception'}});
db.mentalhealth.updateMany({ Insomnia: { $gt: 7, $lte: 10}},{ $set: { Insomnia_categoy: 'High self-perception'}});

db.mentalhealth.updateMany({ OCD: { $gte: 0, $lte: 3}},{ $set: { OCD_categoy: 'Low self-perception'}});
db.mentalhealth.updateMany({ OCD: { $gt: 3, $lte: 7}}, { $set: { OCD_categoy: 'Medium self-perception'}});
db.mentalhealth.updateMany({ OCD: { $gt: 7, $lte: 10}},{ $set: { OCD_categoy: 'High self-perception'}});


// Timestamp
db.mentalhealth.aggregate([
  {
    $addFields: {
      cleanedTimestamp: {
        $function: {
          body: function(timestamp) {
            return timestamp.replace(/[^\x00-\x7F]/g, "");
          },
          args: ["$Timestamp"],
          lang: "js"
        }
      }
    }
  },
  {
    $addFields: {
      newTimestamp: {
        $cond: [
          { $regexMatch: { input: "$cleanedTimestamp", regex: /^(\d{1,2}\/\d{1,2}\/\d{4})/ } },
          { $toDate: { $substrBytes: ["$cleanedTimestamp", 0, { $indexOfBytes: ["$cleanedTimestamp", " "] }] } },
          { $toDate: { $substrBytes: ["$cleanedTimestamp", 0, { $indexOfBytes: ["$cleanedTimestamp", " p. m."] }] } }
        ]
      }
    }
  },
  {$addFields: { Timestamp: "$newTimestamp"}},
  {$unset: ["newTimestamp", "cleanedTimestamp"]},
  {$out: "mentalhealth"}
]);
